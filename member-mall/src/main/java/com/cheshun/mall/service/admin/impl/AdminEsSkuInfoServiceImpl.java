package com.cheshun.mall.service.admin.impl;

import com.cheshun.mall.domain.entity.EsSkuInfo;
import com.cheshun.mall.domain.mapper.GoodsInfosMapper;
import com.cheshun.mall.service.admin.AdminEsSkuInfoService;
import com.cheshun.mall.vo.dto.EsSkuInfoPO;
import com.cheshun.mall.vo.dto.EsSkuInfoVO;
import com.github.pagehelper.PageHelper;
import com.github.pagehelper.PageInfo;
import com.cheshun.common.api.web.http.common.ListResult;
import com.cheshun.common.component.page.PageCondition;
import com.cheshun.common.result.Result;
import com.cheshun.common.tools.utils.ResultUtil;
import com.cheshun.mall.constant.CommontBooleanStatusType;
import com.cheshun.mall.constant.OperationType;
import com.cheshun.mall.domain.dao.EsGoodsSkuRepository;
import com.cheshun.mall.domain.entity.GoodsInfos;
import lombok.extern.slf4j.Slf4j;
import org.elasticsearch.index.query.BoolQueryBuilder;
import org.elasticsearch.index.query.QueryBuilders;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.PageRequest;
import org.springframework.data.domain.Pageable;
import org.springframework.data.domain.Sort;
import org.springframework.data.elasticsearch.core.*;
import org.springframework.data.elasticsearch.core.query.NativeSearchQuery;
import org.springframework.data.elasticsearch.core.query.NativeSearchQueryBuilder;
import org.springframework.stereotype.Service;
import org.springframework.util.ObjectUtils;

import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

import static com.cheshun.common.constant.CommonServiceConstant.SU;
import static com.cheshun.common.result.Result.ERR_CODE;
import static com.cheshun.common.tools.utils.DateTimeUtil.USUAL_DATE_TIME_FORMAT_VALUE;

@Slf4j
@Service
public class AdminEsSkuInfoServiceImpl implements AdminEsSkuInfoService {


    @Autowired
    private GoodsInfosMapper goodsInfosMapper;
    @Autowired
    private EsGoodsSkuRepository esGoodsSkuRepository;
    @Autowired
    private ElasticsearchRestTemplate elasticsearchTemplate;
    // 用于复杂查询
    @Autowired
    private ElasticsearchOperations elasticsearchOperations;

    @Override
    public void importData() {
        try {
            List<GoodsInfos> goodsInfos = goodsInfosMapper.selectImportGoodsForSku();
            log.info("从数据库查询到 {} 条商品数据", goodsInfos.size());

            // 将goodsList 转化成 EsSkuInfo 对象
            List<EsSkuInfo> esSkuInfoList = goodsInfos.stream().map(goodsInfo -> {
                EsSkuInfo esSkuInfo = new EsSkuInfo();
                //
                copyDto2Eso(goodsInfo, esSkuInfo);
                return esSkuInfo;
            }).collect(Collectors.toList());

            //500条分批导入ES
            int batchSize = 500;
            for (int i = 0; i < esSkuInfoList.size(); i += batchSize) {
                int toIndex = Math.min(i + batchSize, esSkuInfoList.size());
                List<EsSkuInfo> batchList = esSkuInfoList.subList(i, toIndex);
                esGoodsSkuRepository.saveAll(batchList);
                log.info("成功导入第 {} 到 {} 条数据到ES", i + 1, toIndex);
            }
            log.info("全部数据导入完成，共导入 {} 条数据", esSkuInfoList.size());

            // 将goodsList 转化成 EsSkuInfo 对象
            List<EsSkuInfo> esSkuInfoB2cList = goodsInfos.stream().map(goodsInfo -> {
                EsSkuInfo esSkuInfo = new EsSkuInfo();
                //
                copyB2cDto2Eso(goodsInfo, esSkuInfo);
                return esSkuInfo;
            }).collect(Collectors.toList());

            //500条分批导入ES
            int batchSizeB2c = 500;
            for (int i = 0; i < esSkuInfoB2cList.size(); i += batchSizeB2c) {
                int toIndexB2c = Math.min(i + batchSizeB2c, esSkuInfoB2cList.size());
                List<EsSkuInfo> batchListB2c = esSkuInfoB2cList.subList(i, toIndexB2c);
                esGoodsSkuRepository.saveAll(batchListB2c);
                log.info("成功导入B2C第 {} 到 {} 条数据到ES", i + 1, toIndexB2c);
            }
            log.info("全部B2C数据导入完成，共导入 {} 条数据", esSkuInfoB2cList.size());

        } catch (Exception e) {
            log.error("后管-刷新导入商品sku到ES接口时发生异常 ", e);
            throw new RuntimeException("后管-刷新导入商品sku到ES接口时发生异常", e);
        }
    }

    @Override
    public Result add(EsSkuInfoVO esSkuInfoVO) {
        try {

            //校验
            if (null == esSkuInfoVO.getSkuId() || "".equals(esSkuInfoVO.getSkuId())) {
                log.error("商品skuId不能为空 ");
                return ResultUtil.result(ERR_CODE,"商品skuId不能为空！");
            }
            EsSkuInfo esSkuInfoExist = esGoodsSkuRepository.findById(esSkuInfoVO.getSkuId())
                    .orElse(null);
            if (null != esSkuInfoExist) {
                log.error("后管-根据id添加单个商品sku， skuId={} 的商品sku已存在，请勿重复添加", esSkuInfoVO.getSkuId());
                return ResultUtil.result(ERR_CODE,"商品sku已存在，请勿重复添加！");
            }

            EsSkuInfo esSkuInfo = new EsSkuInfo();
            copyVo2Dto(esSkuInfoVO, esSkuInfo, OperationType.INSERT);
            esGoodsSkuRepository.save(esSkuInfo);
            return SU;
        } catch (Exception e) {
            log.error("后管-热搜词添加时发生异常， esHotSearchVO={} ", esSkuInfoVO.toString(), e);
            throw new RuntimeException("后管-热搜词添加时发生异常", e);
        }
    }

    @Override
    public Result batchAdd(List<EsSkuInfoVO> esSkuInfoVOList) {
        return null;
    }

    @Override
    public Result adminQueryByCondition(PageCondition pageCondition, Integer minSort, Integer maxSort, String goodsName, String symptoms) {
        try {
            // 分页查询
            if (pageCondition == null || !pageCondition.getIsPage()) {
                pageCondition = new PageCondition();
            }
            //强制分页
            PageHelper.startPage(pageCondition.getPageNum(), pageCondition.getPageSize());

            // 构建布尔查询
            BoolQueryBuilder boolQuery = QueryBuilders.boolQuery();

            // 条件1：优先级范围（minSort ~ maxSort）
            if (minSort != null || maxSort != null) {
                boolQuery.filter(QueryBuilders.rangeQuery("clickCount")
                        .gte(minSort != null ? minSort : Integer.MIN_VALUE)  // 若minSort为null，则不限制最小值
                        .lte(maxSort != null ? maxSort : Integer.MAX_VALUE)); // 若maxSort为null，则不限制最大值
            }

            // 条件2：商品名模糊匹配（支持中文分词）
            if (goodsName != null && !goodsName.isEmpty()) {
                // 1. 保留原有分词匹配（提高精准度）
                boolQuery.should(QueryBuilders.matchQuery("goodsName", goodsName).boost(2.0f))
                        // 2. 新增通配符模糊匹配（支持部分字符匹配，如"99"匹配"999"）
                        .should(QueryBuilders.wildcardQuery("goodsName", "*" + goodsName + "*").boost(1.0f));
            }

            // 条件3：适用症状（包含所有指定症状）
            if (symptoms != null && !symptoms.isEmpty()) {
                boolQuery.must(QueryBuilders.termsQuery("symptoms", symptoms));
            }

            //当条件都为空时
            if (minSort == null && maxSort == null && (goodsName == null || goodsName.isEmpty()) && (symptoms == null || symptoms.isEmpty())) {
                boolQuery.must(QueryBuilders.matchAllQuery());
            }

            // 构建分页( // 注意：前端传过来的page通常是从1开始，ES需要转换为从0开始)
            Pageable pageable = PageRequest.of(pageCondition.getPageNum() - 1, pageCondition.getPageSize());

            // 构建完整查询（默认按goodsCode升序排序，方便运营端查看优先级）
            NativeSearchQuery query = new NativeSearchQueryBuilder()
                    .withQuery(boolQuery)
                    .withSort(Sort.by(Sort.Direction.ASC, "goodsCode"))
                    .withPageable(pageable)
                    .build();

            // 执行查询
            SearchHits<EsSkuInfo> searchHits = elasticsearchTemplate.search(query, EsSkuInfo.class);
            SearchPage<EsSkuInfo> page = SearchHitSupport.searchPageFor(searchHits, query.getPageable());

            List<EsSkuInfo> pageContentList = new ArrayList<>();
            for (SearchHit<EsSkuInfo> searchHit : searchHits) {
                EsSkuInfo dto = searchHit.getContent();
                pageContentList.add(dto);
            }

            //Page<ESHotSearch> queryPage = elasticsearchOperations.queryForPage(query, ESHotSearch.class);
            //List<ESHotSearch> pageContentList = queryPage.getContent();
            //queryPage.get

            List<EsSkuInfoPO> adminEsSkuInfoPOList = new ArrayList<>();
            pageContentList.stream().forEach(dto -> {
                EsSkuInfoPO po = new EsSkuInfoPO();
                copyDto2Po(dto, po);
                adminEsSkuInfoPOList.add(po);
            });

            ListResult<EsSkuInfoPO> adminEsSkuInfoResult = null;
            if (pageCondition.getIsPage()) {
                PageInfo<EsSkuInfoPO> pageInfo = new PageInfo<>(adminEsSkuInfoPOList);
                pageInfo.setTotal(page.getTotalElements());
                pageInfo.setPages(page.getTotalPages());
                pageInfo.setPageNum(page.getNumber());
                pageInfo.setPageSize(page.getSize());
                adminEsSkuInfoResult = ResultUtil.listResult(pageInfo);
            } else {
                adminEsSkuInfoResult = ResultUtil.listResult(SU, adminEsSkuInfoPOList);
            }

            //结果包装
            return adminEsSkuInfoResult;
        } catch (Exception e) {
            log.error("后管-按条件查询热搜词（分页）列表时发生异常， isPage={} pageNum={} pageSize={}",
                    pageCondition.getIsPage(), pageCondition.getPageNum(), pageCondition.getPageSize(), e);
            throw new RuntimeException("后管-按条件查询热搜词（分页）列表时发生异常", e);
        }
    }

    @Override
    public Result adminQueryDetail(String skuId) {

        try {
            // 校验
            if (skuId == null || "".equals(skuId)) {
                log.error("商品skuId不能为空 ");
                return ResultUtil.result(ERR_CODE,"商品skuId不能为空！");
            }

            // 构建布尔查询
            BoolQueryBuilder boolQuery = QueryBuilders.boolQuery();
            boolQuery.filter(QueryBuilders.termsQuery("skuId", skuId));

            // 构建完整查询（默认按goodsCode升序排序，方便运营端查看优先级）
            NativeSearchQuery query = new NativeSearchQueryBuilder()
                    .withQuery(boolQuery)
                    .withSort(Sort.by(Sort.Direction.ASC, "goodsCode"))
                    .build();

            // 执行查询
            SearchHits<EsSkuInfo> searchHits = elasticsearchTemplate.search(query, EsSkuInfo.class);

            if (ObjectUtils.isEmpty(searchHits) || searchHits.isEmpty()) {
                log.error("商品skuId不存在 ");
                return ResultUtil.result(ERR_CODE,"商品skuId不存在！");
            }

            EsSkuInfo dto = null;
            if (!ObjectUtils.isEmpty(searchHits) && searchHits.hasSearchHits()) {
                SearchHit<EsSkuInfo> searchHitDto = searchHits.getSearchHits().get(0);
                dto = searchHitDto.getContent();
            }

            EsSkuInfoPO po = new EsSkuInfoPO();
            copyDto2Po(dto, po);

            //结果包装
            return ResultUtil.result(po);
        } catch (Exception e) {
            log.error("后管-查看单个商品sku详情时发生异常， skuId={} ", skuId, e);
            throw new RuntimeException("后管-查看单个商品sku详情时发生异常", e);
        }
    }

    @Override
    public Result update(EsSkuInfoVO esSkuInfoVO) {
        try {
            //校验
            if (null == esSkuInfoVO.getSkuId() || "".equals(esSkuInfoVO.getSkuId())) {
                log.error("商品skuId不能为空 ");
                return ResultUtil.result(ERR_CODE,"商品skuId不能为空！");
            }
            EsSkuInfo esSkuInfoExist = esGoodsSkuRepository.findById(esSkuInfoVO.getSkuId())
                    .orElse(null);
            if (null == esSkuInfoExist) {
                log.error("后管-根据id更新单个热搜词， skuId={} 商品skuId不存在", esSkuInfoVO.getSkuId());
                return ResultUtil.result(ERR_CODE,"商品skuId不存在！");
            }

            //EsSkuInfo esSkuInfo = new EsSkuInfo();
            copyVo2Dto(esSkuInfoVO, esSkuInfoExist, OperationType.UPDATE);
            esGoodsSkuRepository.save(esSkuInfoExist);
            return SU;
        } catch (Exception e) {
            log.error("后管-修改单个商品sku时发生异常， esSkuInfoVO={} ", esSkuInfoVO.toString(), e);
            throw new RuntimeException("后管-修改单个商品sku时发生异常", e);
        }
    }

    @Override
    public Result delete(EsSkuInfoVO esSkuInfoVO) {
        try {
            if (null == esSkuInfoVO.getSkuId() || "".equals(esSkuInfoVO.getSkuId())) {
                log.error("商品skuId不能为空 ");
                return ResultUtil.result(ERR_CODE,"商品skuId不能为空！");
            }
            EsSkuInfo esSkuInfoExist = esGoodsSkuRepository.findById(esSkuInfoVO.getSkuId())
                    .orElse(null);
            if (null == esSkuInfoExist) {
                log.error("后管-根据id删除单个商品sku， skuId={} 商品sku不存在", esSkuInfoVO.getSkuId());
                return ResultUtil.result(ERR_CODE,"商品sku不存在！");
            }

            esGoodsSkuRepository.deleteById(esSkuInfoVO.getSkuId());
            return SU;
        } catch (Exception e) {
            log.error("后管-根据id删除单个商品sku时发生异常， skuId={} ", esSkuInfoVO.getSkuId(), e);
            throw new RuntimeException("后管-根据id删除单个商品sku时发生异常", e);
        }
    }

    @Override
    public void batchDelete(List<EsSkuInfoVO> esSkuInfoVOList) {

    }

    /**
     * VO复制到DTO
     * @param vo
     * @param dto
     */
    private void copyVo2Dto(EsSkuInfoVO vo, EsSkuInfo dto, OperationType operationType) {
        //不论新增还是更新，skuId必须赋值
        dto.setSkuId(vo.getSkuId());
        dto.setGoodsId(vo.getGoodsId());
        dto.setGoodsCode(vo.getGoodsCode());
        dto.setGoodsName(vo.getGoodsName());
        dto.setSubTitle(vo.getSubTitle());
        dto.setRetailPrice(vo.getRetailPrice());
        dto.setMainImage(vo.getMainImage());
        dto.setStatus(vo.getStatus());
        dto.setIsB2c(vo.getIsB2c());
        if (OperationType.INSERT.equals(operationType)) {
            dto.setCreateTime(LocalDateTime.now());
        } else if (OperationType.UPDATE.equals(operationType)) {
            dto.setUpdateTime(LocalDateTime.now());
        }
        dto.setIsDefault(CommontBooleanStatusType.YES.getCode());
        dto.setSpuId(vo.getSpuId());
        //dto.setCategoryId(vo.getSpu());
        dto.setOriginManuf(vo.getOriginManuf());
        dto.setSpec(vo.getSpec());
        dto.setSymptoms(vo.getSymptoms()); //多种症状，英文逗号拼接
    }

    /**
     * Dto复制到Eso
     * @param dto
     * @param esSkuInfo
     */
    private void copyDto2Eso(GoodsInfos dto, EsSkuInfo esSkuInfo) {
        //po.setConfigId(configDTO.getConfigId());
        esSkuInfo.setSkuId(String.format("0%s", dto.getSku()));
        esSkuInfo.setGoodsId(dto.getGoodsId());
        esSkuInfo.setGoodsCode(dto.getGoodsCode());
        esSkuInfo.setGoodsName(dto.getProductName());
        esSkuInfo.setSubTitle(dto.getSubTitle());
        esSkuInfo.setRetailPrice(dto.getRetailPrice());
        esSkuInfo.setMainImage(dto.getMainImage());
        esSkuInfo.setStatus(dto.getStatus().byteValue());
        esSkuInfo.setIsB2c(CommontBooleanStatusType.NO.getCode());////设置isB2c=false
        esSkuInfo.setCreateTime(dto.getCreatetime());
        esSkuInfo.setUpdateTime(dto.getModifytime());
        esSkuInfo.setIsDefault(CommontBooleanStatusType.YES.getCode());
        esSkuInfo.setSpuId(dto.getSpu());
        //esSkuInfo.setCategoryId(dto.getSpu());
        esSkuInfo.setOriginManuf(dto.getOriginAddress());
        esSkuInfo.setSpec(dto.getSpecification());
        esSkuInfo.setSymptoms("");
        esSkuInfo.setSubbhStr(subbhStr);
    }

    /**
     * Dto复制到Eso
     * @param dto
     * @param esSkuInfo
     */
    private void copyB2cDto2Eso(GoodsInfos dto, EsSkuInfo esSkuInfo) {
        //po.setConfigId(configDTO.getConfigId());
        esSkuInfo.setSkuId(String.format("1%s", dto.getSku()));
        esSkuInfo.setGoodsId(dto.getGoodsId());
        esSkuInfo.setGoodsCode(dto.getGoodsCode());
        esSkuInfo.setGoodsName(dto.getProductName());
        esSkuInfo.setSubTitle(dto.getSubTitle());
        esSkuInfo.setRetailPrice(dto.getRetailPrice());
        esSkuInfo.setMainImage(dto.getMainImage());
        esSkuInfo.setStatus(dto.getStatus().byteValue());
        esSkuInfo.setIsB2c(CommontBooleanStatusType.YES.getCode());//设置isB2c=1
        esSkuInfo.setCreateTime(dto.getCreatetime());
        esSkuInfo.setUpdateTime(dto.getModifytime());
        esSkuInfo.setIsDefault(CommontBooleanStatusType.YES.getCode());
        esSkuInfo.setSpuId(dto.getSpu());
        //esSkuInfo.setCategoryId(dto.getSpu());
        esSkuInfo.setOriginManuf(dto.getOriginAddress());
        esSkuInfo.setSpec(dto.getSpecification());
        esSkuInfo.setSymptoms("");
        esSkuInfo.setSubbhStr(subbhStr);
    }

    /**
     * DTO复制到PO
     * @param item
     * @param po
     */
    private void copyDto2Po(EsSkuInfo item, EsSkuInfoPO po) {
        //po.setConfigId(configDTO.getConfigId());
        po.setSkuId(item.getSkuId());
        po.setGoodsId(item.getGoodsId());
        po.setGoodsCode(item.getGoodsCode());
        po.setGoodsName(item.getGoodsName());
        po.setSubTitle(item.getSubTitle());
        po.setRetailPrice(item.getRetailPrice());
        po.setMainImage(item.getMainImage());
        po.setStatus(item.getStatus());
        po.setIsB2c(item.getIsB2c());
        String createTimeStr = null == item.getCreateTime() ? "" : DateTimeFormatter.ofPattern(USUAL_DATE_TIME_FORMAT_VALUE).format(item.getCreateTime());
        po.setCreateTimeStr(createTimeStr);
        String updateTimeStr = null == item.getUpdateTime() ? "" : DateTimeFormatter.ofPattern(USUAL_DATE_TIME_FORMAT_VALUE).format(item.getUpdateTime());
        po.setUpdateTimeStr(updateTimeStr);
        po.setIsDefault(item.getIsDefault());
        po.setSpuId(item.getSpuId());
        po.setCategoryId(item.getCategoryId());
        po.setCategoryName(item.getCategoryName());
        po.setOriginManuf(item.getOriginManuf());
        po.setSpec(item.getSpec());
        po.setNum(item.getNum());
        /*po.setClickCount(item.getClickCount());
        po.setScore(item.getClickCount());*/
        po.setSymptoms(item.getSymptoms());
        po.setSubbhStr(item.getSubbhStr());
    }

    static String subbhStr = "03701001,03701002,03701003,03701004,03701005,03701006,03701007,03701008,03701009,03701010,03701011,03701012,03701013,03701014,03701015,03701016,03701017,03701018,03701019,03701020,03701021,03701023,03701024,03701025,03701026,03701027,03701028,03701029,03701030,03701031,03701032,03701033,03701034,03701035,03701036,03701037,03701038,03701039,03701040,03701041,03701042,03701043,03701044,03701045,03701046,03701047,03701048,03701049,03701050,03701051,03701052,03701053,03701054,03701055,03701056,03701057,03701058,03701059,03701060,03701061,03701062,03701063,03701064,03701065,03701066,03701067,03701068,03701069,03701070,03701071,03701072,03701073,03701074,03701075,03701076,03701077,03701078,037040001,03710001,03711001,03711002,03711003,03711004,03711006,03711007,03711009,03711011,03711013,03711017,03711019,03711020,03711021,03711022,03711024,03711025,03711026,03711028,03711029,03711030,03711031,03711032,03711033,03711034,03711038,03711039,03711040,03711041,03711043,03711044,03711045,03711046,03711047,03711049,03711050,03711051,03711052,03711053,03711054,03711055,03711056,03711057,03711058,03711059,03711062,03711063,03711064,03711065,03711066,03711067,03711068,03711070,03711071,03711072,03711073,03711074,03711076,03711077,03711078,03711079,03711080,03711081,03711082,03711083,03711084,03711085,03711086,03711088,03711089,03711090,03711092,03711093,03711094,03711095,03711096,03711097,03711098,03711099,03711100,03711101,03711102,03711103,03711104,03711105,03711106,03711107,03711108,03711109,03711110,03711111,03711112,03711113,03711114,03711115,03711116,03711117,03711118,03711119,03711120,03711121,03711122,03711123,03711124,03711125,03711126,03711127,03711128,03711129,03711130,03711131,03711132,03711133,03711134,03711135,03711136,03711137,03711138,03711139,03711140,03711141,03711142,03711143,03711144,03711145,03711146,03711147,03711148,03711149,03711150,03711151,03711152,03711153,03711154,03711155,03711156,03711157,03711158,03711159,03711160,03711161,03711162,03711163,03711164,03711165,03711166,03981040,03981041,03981042,039840001,039860001,04571001,04571002,04571003,08981001,08981002,08981003,089860001,1400001,1400002,1400003,03711167,03711168,03711169,03711170,03711171,03711172,03711173,03711174,03711175,03711176,03711177,03711178,03711179,03711180,03711181,03711182,03711183,03711184,03711185,03711186,03711187,03711188,03711189,03711190,03711191,03711192,03711193,03711194,03711195,03711196,03711197,03711198,03711199,03711200,037112001,03711201,03711202,03711203,03711204,03711205,03711206,03711207,03711208,03711209,03711210,03711211,03711212,03711213,03711214,03711215,03711216,03711217,03711218,03711219,03711220,03711221,03711222,03711223,03711224,03711225,03711226,03711227,03711228,03711229,03711230,03711231,03711232,03711233,03711234,03711235,03711236,03711237,03711238,03711239,03711240,03711241,03711242,03711243,03711244,03711245,03711246,03711247,03711248,03711249,03711250,03711251,03711252,03711253,03711254,03711255,03711256,03711257,03711258,03711259,03711260,03711261,03711262,03711263,03711264,03711265,03711266,03711267,03711268,03711269,03711270,03711271,03711272,03711273,03711274,03711275,03711276,03711277,03711278,03711279,03711280,03711281,03711282,03711283,03711284,03711285,03711286,03711287,03711288,03711289,03711290,03711291,03711292,03711293,03711294,03711295,03711296,03711297,03711298,03711299,03711300,03711301,03711302,03711303,03711304,03711305,03711306,03711307,03711308,03711309,03711310,03711311,03711312,03711313,03711314,03711315,03711316,03711317,03711318,03711319,03711320,03711321,03711322,03711323,03711324,03711325,03711326,03711327,03711328,03711329,03711330,03711331,03711332,03711333,03711334,03711335,03711336,03711337,03711338,03711339,03711340,03711341,03711342,03711343,03711344,03711345,03711346,03711347,03711348,03711349,03711350,03711351,03711352,03711353,03711354,03711355,03711356,03711357,03711358,03711359,03711360,03711361,03711362,03711363,03711364,03711365,03711366,03711367,03711368,03711369,03711370,03711371,03711372,03711373,03711374,03711375,03711376,03711377,03711378,03711379,03711380,03711381,03711382,03711383,03711384,03711385,03711386,03711387,03711388,03711389,03711390,03711391,03711392,03711393,03711394,03711395,03711396,03711397,03711398,03711399,03711400,03711401,03711402,03711403,03711404,03711405,03711406,03711407,03711408,03711409,03711410,03711411,03711412,03711413,03711414,03711415,03711416,03711417,03711418,03711419,03711420,03711421,03711422,03711423,03711424,03711425,03711426,03711427,03711428,03711429,03711430,03711431,03711432,03711433,03711434,03711435,03711436,03711437,03711438,03711439,03711440,03711441,03711442,03711443,03711444,03711445,03711446,03711447,03711448,03711449,03711450,03711451,03711452,03711453,03711454,03711455,03711456,03711457,03711458,03711459,03711460,03711461,03711462,03711463,03711464,03711465,03711466,03711467,03711468,03711469,03711470,03711471,03711472,03711473,03711474,03711475,03711476,03711477,03711478,03711479,03711480,03711481,03711482,03711483,03711484,03711485,03711486,03711487,03711488,03711489,03711490,03711491,03711492,03711493,03711494,03711495,03711496,03711497,03711498,03711499,03711500,03711501,03711502,03711503,03711504,03711505,03711506,03711507,03711508,03711509,03711510,03711511,03711512,03711513,03711514,03711515,03711516,03711517,03711518,03711519,03711520,03711521,03711522,03711523,03711524,03711525,03711526,03711527,03711528,03711529,03711530,03711531,03711532,03711533,03711534,03711535,03711536,03711537,03711538,03711539,03711540,03711541,03711542,03711543,03711544,03711545,03711546,03711547,03711548,03711549,03711550,03711551,03711552,03711553,03711554,03711555,03711556,03711557,03711558,03711559,03711560,03711561,03711562,03711563,03711564,03711565,03711566,03711567,03711568,03711569,03711570,03711571,03711572,03711573,03711574,03711575,03711576,03711577,03711578,03711579,03711580,03711581,03711582,03711583,03711584,03711585,03711586,03711587,03711588,03711589,03711590,03711591,03711592,03711593,03711594,03711595,03711596,03711597,03711598,03711599,03711600,03711601,03711602,03711603,03711604,03711605,03711606,03711607,03711608,03711609,03711610,03711611,03711612,03711613,03711614,03711615,03711616,03711617,03711618,03711619,03711620,03711621,03711622,03711623,03711624,03711625,03711626,03711627,03711628,03711629,03711630,03711631,03711632,03711633,03711634,03711635,03711636,03711637,03711638,03711639,03711640,03711641,03711642,03711643,03711644,03711645,03711646,03711647,03711648,03711649,03711650,03711651,03711652,03711653,03711654,03711655,03711656,03711657,03711658,03711659,03711660,03711661,03711662,03711663,03711664,03711665,03711666,03711667,03711668,03711669,03711670,03711671,03711672,03711673,03711674,03711675,03711676,03711677,03711678,03711679,03711680,03711681,03711682,03711683,03711684,03711685,03711686,03711687,03711688,03711689,03711690,03711691,03711692,03711693,03711694,03711695,03711696,03711697,03711698,03711699,03711700,03711701,03711702,03711703,03711704,03711705,03711706,03711707,03711708,03711709,03711710,03711711,03711712,03711713,03711714,03711715,03711716,03711717,03711718,03711719,03711720,03711721,03711722,03711723,03711724,03711725,03711726,03711727,03711728,03711729,03711730,03711731,03711732,03711733,03711734,03711735,03711736,03711737,03711738,03711739,03711740,03711741,03711742,03711743,03711744,03711745,03711746,03711747,03711748,03711749,03711750,03711751,03711752,03711753,03711754,03711755,03711756,03711757,03711758,03711759,03711760,03711761,03711762,03711763,03711764,03711765,03711766,03711767,03711768,03711769,03711770,03711771,03711772,03711773,03711774,03711775,03711776,03711777,03711778,03711779,03711780,03711781,03711782,03711783,03711784,03711785,03711786,03711787,03711788,03711789,03711790,03711791,03711792,03711793,03711794,03711795,03711796,03711797,03711798,03711799,03711800,03711801,03711802,03711803,03711804,03711805,03711806,03711807,03711808,03711809,03711810,03711811,03711812,03711813,03711814,03711815,03711816,03711817,03711818,03711819,03711820,03711821,03711822,03711823,03711824,03711825,03711826,03711827,03711828,03711829,03711830,03711831,03711832,03711833,03711834,03711835,03711836,03711837,03711838,03711839,03711840,03711841,03711842,03711843,03711844,03711845,03711846,03711847,03711848,03711849,03711850,03711851,03711852,03711853,03711854,03711855,03711856,03711857,03711858,03711859,03711860,03711861,03711862,03711863,03711864,03711865,03711866,03711867,03711868,03711869,03711870,03711871,03711872,03711873,03711874,03711875,03711876,03711877,03711878,03711879,03711880,03711881,03711882,03711883,03711884,03711885,03711886,03711887,03711888,03711889,03711890,03711891,03711892,03711893,03711894,03711895,03711896,03711897,03711898,03711899,03711900,03711901,03711902,03711903,03711904,03711905,03711906,03711907,03711908,03711909,03711910,03711911,03711912,03711913,03711914,03711915,03711916,03711917,03711918,03711919,03711920,03711921,03711922,03711923,03711924,03711925,03711926,03711927,03711928,03711929,03711930,03711931,03711932,03711933,03711934,03711935,03711936,03711937,03711938,03711939,03711940,03711941,03711942,03711943,03711944,03711945,03711946,03711947,03711948,03711949,03711950,03711951,03711952,03711953,03711954,03711955,03711956,03711957,03711958,03711959,03711960,03711961,03711962,03711963,03711964,03711965,03711966,03711967,03711968,03711969,03711970,03711971,03711972,03711973,03711974,03711975,03711976,03711977,03711978,03711979,03711980,03711981,03711982,03711983,03711984,03711985,03711986,03711987,03711988,03711989,03711990,03711991,03711992,03711993,03711994,03711995,03711996,03711997,03711998,03711999,03712000,03712001,03712002,03712003,03712004,03712005,03712006,03712007,03712008,03712009,03712010,03712011,03712012,03712013,03712014,03712015,03712016,03712017,03712018,03712019,03712020,03712021,03712022,03712023,03712024,03712025,03712026,03712027,03712028,03712029,03712030,03712031,03712032,03712033,03712034,03712035,03712036,03712037,03712038,03712039,03712040,03712041,03712042,03712043,03712044,03712045,03712046,03712047,03712048,03712049,03712050,03712051,03712052,03712053,03712054,03712055,03712056,03712057,03712058,03712059,03712060,03712061,03712062,03712063,03712064,03712065,03712066,03712067,03712068,03712069,03712070,03712071,03712072,03712073,03712074,03712075,03712076,03712077,03712078,03712079,03712080,03712081,03712082,03712083,03712084,03712085,03712086,03712087,03712088,03712089,03712090,03712091,03712092,03712093,03712094,03712095,03712096,03712097,03712098,03712099,03712100,03712101,03712102,03712103,03712104,03712105,03712106,03712107,03712108,03712109,03712110,03712111,03712112,03712113,03712114,03712115,03712116,03712117,03712118,03712119,03712120,03712121,03712122,03712123,03712124,03712125,03712126,03712127,03712128,03712129,03712130,03712131,03712132,03712133,03712134,03712135,03712136,03712137,03712138,03712139,03712140,03712141,03712142,03712143,03712144,03712145,03712146,03712147,03712148,03712149,03712150,03712151,03712152,03712153,03712154,03712155,03712156,03712157,03712158,03712159,03712160,03712161,03712162,03712163,03712164,03712165,03712166,03712167,03712168,03712169,03712170,03712171,03712172,03712173,03712174,03712175,03712176,03712177,03712178,03712179,03712180,03712181,03712182,03712183,03712184,03712185,03712186,03712187,03712188,03712189,03712190,03712191,03712192,03712193,03712194,03712195,03712196,03712197,03712198,03712199,03712200,03712201,03712202,03712203,03712204,03712205,03712206,03712207,03712208,03712209,03712210,03712211,03712212,03712213,03712214,03712215,03712216,03712217,03712218,03712219,03712220,03712221,03712222,03712223,03712224,03712225,03712226,03712227,03712228,03712229,03712230,03712231,03712232,03712233,03712234,03712235,03712236,03712237,03712238,03712239,03712240,03712241,03712242,03712243,03712244,03712245,03712246,03712247,03712248,03712249,03712250,03712251,03712252,03712253,03712254,03712255,03712256,03712257,03712258,03712259,03712260,03712261,03712262,03712263,03712264,03712265,03712266,03712267,03712268,03712269,03712270,03712271,03712272,03712273,03712274,03712275,03712276,03712277,03712278,03712279,03712280,03712281,03712282,0371269,037140001,037140003,037140004,037140005,037140006,037140007,037140008,037140009,037140010,037140011,037140012,037140013,037140014,037140015,037140016,037140017,037140018,037140019,037140020,037140021,037140022,037160001,03719999,03721001,03721002,03721003,03721004,03721005,03721006,03721007,03721008,03721009,03721010,03721011,03721012,03721013,03721014,03721015,03721016,03721017,03721018,03721019,03721020,03721021,03721022,03721023,03721024,03721025,03721026,03721027,03721028,03721029,03721030,03721031,03721032,03721033,03721034,03721035,03721036,03721037,03721038,03721039,03721040,03721041,03721042,03721043,03721044,03721045,03721046,03721047,03721048,03721049,03721050,03721051,03721052,03721053,03721054,03721055,03721056,03721057,03721058,03721059,03721060,03721061,03721062,03721063,03721064,03721065,03721066,03721067,03721068,03721069,03721070,03721071,03721072,03721073,03721074,03721075,03721076,03721077,03721078,03721079,03721080,03721081,03721082,03721083,03721084,03721085,03721086,037240001,037260001,03731001,03731002,03731003,03731004,03731005,03731006,03731007,03731008,03731009,03731010,03731011,03731012,03731013,03731014,03731015,03731016,03731017,03731018,03731019,03731020,03731021,03731022,03731023,03731024,03731025,03731026,03731027,03731028,03731029,03731030,03731031,03731032,03731033,03731034,03731035,03731036,03731037,03731038,03731039,03731040,03731041,03731042,03731043,03731044,03731045,03731046,03731047,03731048,03731049,03731050,03731051,03731052,03731053,03731054,03731055,03731056,03731057,03731058,03731059,03731060,03731061,03731062,03731063,03731064,03731065,03731066,03731067,03731068,03731069,03731070,03731071,03731072,03731073,03731074,03731075,03731076,03731077,03731078,03731079,03731080,03731081,03731082,03731083,03731084,03731085,03731086,03731087,03731088,03731089,03731090,03731091,03731092,03731093,03731094,03731095,03731096,03731097,03731098,03731099,03731100,03731101,03731102,03731103,03731104,03731105,03731106,03731107,03731108,03731109,03731110,03731111,03731112,03731113,03731114,03731115,03731116,03731117,03731118,03731119,03731120,03731121,03731122,03731123,03731124,03731125,03731126,03731127,03731128,03731129,03731130,03731131,03731132,03731133,03731134,03731135,03731136,03731137,03731138,03731139,03731140,03731141,03731142,03731143,03731144,03731145,03731146,03731147,03731148,03731149,03731150,03731151,03731152,03731153,03731154,03731155,03731156,03731157,03731158,03731159,03731160,03731161,03731162,03731163,03731164,03731165,03731166,03731167,03731168,03731169,03731170,03731171,03731172,03731173,03731174,03731175,03731176,03731177,03731178,03731179,03731180,03731181,03731182,03731183,03731184,03731185,03731186,03731187,03731188,03731189,03731190,03731191,03731192,03731193,03731194,03731195,03731196,03731197,03731198,03731199,03731200,03731201,03731202,03731203,03731204,03731205,03731206,03731207,03731208,03731209,037340001,037340002,037340003,037340004,037360001,037360002,03741001,03741002,03741003,03741004,03741005,03741006,03741007,03741008,03741009,03741010,03741011,03741012,03741013,03741014,03741015,03741016,03741017,03741018,03741019,03741020,03741021,03741022,03741023,03741024,03741025,03741026,03741027,03741028,03741029,03741030,03741031,03741032,03741033,03741034,03741035,03741036,03741037,03741038,03741039,03741040,03741041,03741042,03741043,03741044,03741045,03741046,03741047,03741048,03741049,03741050,03741051,03741052,03741053,03741054,03741055,03741056,03741057,03741058,03741059,03741060,03741061,03741062,03741063,03741064,03741065,03741066,03741067,03741068,03741069,03741070,03741071,03741072,03741073,03741074,03741075,03741076,03741077,03741078,03741079,03741080,03741081,03741082,03741083,03741084,03741085,03741086,03741087,03741088,03741089,03741090,03741091,03741092,03741093,03741094,03741095,03741096,03741097,03741098,03741099,03741100,03741101,03741102,03741103,03741104,03741105,03741106,03741107,03741108,03741109,037440001,03751001,03751002,03751003,03751004,03751005,03751006,03751007,03751008,03751009,03751010,03751011,03751012,03751013,03751014,03751015,03751016,03751017,03751018,03751019,03751020,03751021,03751022,03751023,03751024,03751025,03751026,03751027,03751028,03751029,03751030,03751031,03751032,03751033,03751034,03751035,03751036,03751037,03751038,03751039,03751040,03751041,03751042,03751043,03751044,03751045,03751046,03751047,03751048,03751049,03751050,03751051,03751052,03751053,03751054,03751055,03751056,03751057,03751058,03751059,03751060,03751061,03751062,03751063,03751064,03751065,03751066,03751067,03751068,03751069,03751070,03751071,03751072,03751073,03751074,03751075,03751076,03751077,03751078,03751079,03751080,03751081,03751082,03751083,03751084,03751085,03751086,03751087,03751088,03751089,03751090,03751091,03751092,03751093,03751094,03751095,03751096,03751097,03751098,03751099,03751100,03751101,03751102,03751103,03751104,03751105,03751106,03751107,03751108,03751109,03751110,03751111,03751112,03751113,03751114,03751115,03751116,03751117,03751118,03751119,03751120,03751121,03751122,03751123,03751124,03751125,03751126,03751127,03751128,03751129,03751130,03751131,03751132,03751133,03751134,03751135,03751136,03751137,03751138,03751139,03751140,03751141,03751142,03751143,03751144,03751145,03751146,03751147,03751148,03751149,03751150,03751151,03751152,03751153,037540001,037560001,03761001,03761002,03761003,03761004,03761005,03761006,03761007,03761008,03761009,03761010,03761011,03761012,03761013,03761014,03761015,03761016,03761017,03761018,03761019,03761020,03761021,03761022,03761023,03761024,03761025,03761026,03761027,03761028,03761029,03761030,03761031,03761032,03761033,03761034,03761035,03761036,03761037,03761038,03761039,03761040,03761041,03761042,03761043,03761044,03761045,03761046,03761047,03761048,03761049,03761050,03761051,03761052,03761053,03761054,03761055,03761056,03761057,03761058,03761059,03761060,03761061,03761062,03761063,03761064,03761065,03761066,03761067,03761068,03761069,03761070,03761071,03761072,03761073,03761074,03761075,03761076,03761077,03761078,03761079,03761080,03761081,03761082,03761083,03761084,03761085,03761086,03761087,03761088,03761089,03761090,03761091,03761092,03761093,03761094,03761095,03761096,03761097,03761098,03761099,03761100,03761101,03761102,03761103,037640001,037660001,03771001,03771003,03771005,03771006,03771009,03771010,03771011,03771012,03771013,03771014,03771015,03771016,03771017,03771018,03771019,03771020,03771021,03771022,03771023,03771024,03771025,03771026,03771027,03771028,03771029,03771030,03771031,03771032,03771033,03771034,03771036,03771037,03771038,03771039,03771040,03771041,03771042,03771043,03771044,03771045,03771046,03771047,03771048,03771049,03771050,03771051,03771052,03771053,03771054,03771055,03771056,03771057,03771058,03771059,03771060,03771061,03771062,03771063,03771064,03771065,03771066,03771067,03771068,03771069,03771070,03771071,03771072,03771073,03771074,03771075,03771076,03771077,03771078,03771079,03771080,03771081,03771082,03771083,03771084,03771085,03771086,03771087,03771088,03771089,03771090,03771091,03771092,03771093,03771094,03771095,03771096,03771097,03771098,03771099,03771100,03771101,03771102,03771103,03771104,03771105,03771106,03771107,03771108,03771109,03771110,03771111,03771112,03771113,03771114,03771115,03771116,03771117,03771118,03771119,03771120,03771121,03771122,03771123,03771124,03771125,03771126,03771127,03771128,03771129,03771130,03771131,03771132,03771133,03771134,03771135,03771136,03771137,03771138,03771139,03771140,03771141,03771142,03771143,03771144,03771145,03771146,03771147,03771148,03771149,03771150,03771151,03771152,03771153,03771154,03771155,03771156,03771157,03771158,03771159,03771160,03771161,03771162,03771163,03771164,03771165,03771166,03771167,03771168,03771169,03771170,03771171,03771172,03771173,03771174,03771175,03771176,03771177,03771178,03771179,03771180,03771181,03771182,03771183,03771184,03771185,03771186,03771187,03771188,03771189,03771190,03771191,03771192,03771193,03771194,03771195,03771196,03771197,03771198,03771199,03771200,03771201,03771202,03771203,03771204,03771205,03771206,03771207,03771208,03771209,03771210,03771211,03771212,03771213,03771214,03771215,03771216,03771217,03771218,03771219,03771220,03771221,03771222,03771223,03771224,03771225,03771226,03771227,03771228,03771229,03771230,03771231,03771232,03771233,03771234,03771235,03771236,03771237,03771238,03771239,03771240,03771241,03771242,03771243,03771244,03771245,03771246,03771247,03771248,03771249,03771250,03771251,03771252,03771253,03771254,03771255,03771256,03771257,03771258,03771259,03771260,03771261,03771262,03771263,03771264,03771265,03771266,03771267,03771268,03771269,03771270,03771271,03771272,03771273,03771274,03771275,03771276,03771277,03771278,03771279,03771280,03771281,03771282,03771283,03771284,03771285,03771286,03771287,03771288,03771289,03771290,03771291,03771292,03771293,03771294,03771295,03771296,03771297,03771298,03771299,03771300,03771301,03771302,03771303,03771304,03771305,03771306,03771307,03771308,03771309,03771310,03771311,03771312,03771313,03771314,03771315,03771316,03771317,03771318,03771319,03771320,03771321,03771322,03771323,03771324,03771325,03771326,03771327,03771328,03771329,03771330,03771331,037740001,037740002,037740003,037740004,037740005,037740006,037760001,037760002,03781001,03781002,03781003,03781004,03781005,03781006,03781007,03781008,03781009,03781010,03781011,03781012,03781013,03781014,03781015,03781016,03781017,03781018,03781019,03781020,03781021,03781022,03781023,03781024,03781025,03781026,03781027,03781028,03781029,03781030,03781031,03781032,03781033,03781034,03781035,03781036,03781037,03781038,03781039,03781040,03781041,03781042,03781043,03781044,03781045,03781046,03781047,03781048,03781049,03781050,03781051,03781052,03781053,03781054,03781055,03781056,03781057,03781058,03781059,03781060,03781061,03781062,03781063,03781064,03781065,03781066,03781067,03781068,03781069,03781070,03781071,03781072,03781073,03781074,03781075,03781076,03781077,03781078,03781079,03781080,03781081,03781082,03781083,03781084,03781085,03781086,03781087,03781088,03781089,03781090,03781091,037860001,03791001,03791002,03791003,03791004,03791005,03791006,03791007,03791008,03791009,03791010,03791011,03791012,03791013,03791014,03791015,03791016,03791017,03791018,03791019,03791020,03791021,03791022,03791023,03791024,03791025,03791026,03791027,03791028,03791029,03791030,03791031,03791032,03791033,03791034,03791035,03791036,03791037,03791038,03791039,03791040,03791041,03791042,03791043,03791044,03791045,03791046,03791047,03791048,03791049,03791050,03791051,03791052,03791053,03791054,03791055,03791056,03791057,03791058,03791059,03791060,03791061,03791062,03791063,03791064,03791065,03791066,03791067,03791068,03791069,03791070,03791071,03791072,03791073,03791074,03791075,03791076,03791077,03791078,03791079,03791080,03791081,03791082,03791083,03791084,03791085,03791086,03791087,03791088,03791089,03791090,03791091,03791092,03791093,03791094,03791095,03791096,03791097,03791098,03791099,03791100,03791101,03791102,03791103,03791104,03791105,03791106,03791107,03791108,03791109,03791110,03791111,03791112,03791113,03791114,03791115,03791116,03791117,03791118,03791119,03791120,03791121,03791122,03791123,03791124,03791125,03791126,03791127,03791128,03791129,03791130,03791131,03791132,03791133,03791134,03791135,03791136,03791137,03791138,03791139,03791140,03791141,03791142,03791143,03791144,03791145,03791146,03791147,03791148,03791149,03791150,03791151,03791152,03791153,03791154,03791155,03791156,03791157,03791158,03791159,03791160,03791161,03791162,03791163,03791164,03791165,03791166,03791167,03791168,03791169,03791170,03791171,03791172,03791173,03791174,03791175,03791176,03791177,03791178,03791179,03791180,03791181,03791182,03791183,03791184,03791185,03791186,03791187,03791188,03791189,03791190,03791191,03791192,03791193,03791194,03791195,03791196,03791197,03791198,03791199,03791200,03791201,03791202,03791203,03791204,03791205,03791206,03791207,03791208,03791209,03791210,03791211,03791212,03791213,03791214,03791215,03791216,03791217,03791218,03791219,03791220,03791221,03791222,03791223,03791224,03791225,03791226,03791227,03791228,03791229,03791230,03791231,03791232,037940001,037940002,03911001,03911002,03911003,03911004,03911005,03911006,03911007,03911008,03911009,03911010,03911011,03911012,03911013,03911014,03911015,03911016,03911017,03911018,03911019,03911020,03911021,03911022,03911023,03911024,03911025,03911026,03911027,03911028,03911029,03911030,03911031,03911032,03911033,03911034,03911035,03911036,03911037,03911038,03911039,03911040,03911041,03911042,03911043,03911044,03911045,03911046,03911047,03911048,03911049,03911050,03911051,03911052,03911053,03911054,03911055,03911056,03911057,03911058,03911059,03911060,03911061,03911062,03911063,03911064,03911065,03911066,03921002,03921003,03921004,03921005,03921006,03921007,03921008,03921009,03921010,03921011,03921012,03921013,03921014,03921015,03921016,03921017,03921018,03921019,03921020,03921021,03921022,03921023,03921024,03921025,03921026,03921027,03921028,03921029,03921030,03921031,03921032,03921033,03921034,";
}

